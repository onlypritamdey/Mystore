<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - My Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body x-data="checkout()" x-init="init()" class="bg-gray-100">

  <!-- Header -->
  <header class="bg-white shadow p-4 flex justify-between items-center sticky top-0 z-50">
    <h1 class="text-xl font-bold text-emerald-600">Checkout</h1>
    <a href="index.html" class="text-emerald-500 font-semibold hover:underline">â† Continue Shopping</a>
  </header>

  <main class="max-w-md mx-auto p-4 space-y-6">

    <!-- Order Summary -->
    <section class="bg-white p-4 rounded-xl shadow space-y-3">
      <h2 class="text-lg font-semibold text-gray-700">Your Order</h2>

      <template x-for="item in cart" :key="item.id">
        <div class="flex justify-between items-center py-2 border-b">
          <div>
            <p class="font-medium text-gray-800 truncate" x-text="item.name"></p>
            <p class="text-sm text-gray-500">Qty: <span x-text="item.quantity"></span></p>
          </div>
          <div class="text-right">
            <p class="text-gray-500 line-through text-xs" x-show="item.originalPrice && item.originalPrice > item.price">
              â‚¹<span x-text="item.originalPrice * item.quantity"></span>
            </p>
            <p class="font-semibold text-gray-900">â‚¹<span x-text="item.price * item.quantity"></span></p>
          </div>
        </div>
      </template>

      <!-- Totals -->
      <div class="py-2 space-y-1">
        <p class="flex justify-between text-gray-500 text-sm">
          <span>MRP Total:</span>
          <span>â‚¹<span x-text="mrpTotal"></span></span>
        </p>
        <p class="flex justify-between text-red-500 text-sm">
          <span>You Save:</span>
          <span>â‚¹<span x-text="mrpTotal - cartTotal"></span></span>
        </p>
        <p class="flex justify-between text-gray-500 text-sm">
          <span>Delivery:</span>
          <span class="text-emerald-600 font-medium">Free</span>
        </p>
        <p class="flex justify-between text-lg font-bold text-gray-900 border-t pt-2">
          <span>Total:</span>
          <span>â‚¹<span x-text="cartTotal"></span></span>
        </p>
      </div>

      <p class="text-sm text-red-500 font-medium mt-1">ğŸ”¥ Hurry! Grab this deal now!</p>
    </section>

    <!-- Shipping Address -->
    <section class="bg-white p-4 rounded-xl mb-4 shadow space-y-4">
      <h2 class="text-lg font-semibold text-gray-700">Shipping Address</h2>

      <!-- Badges -->
      <div class="flex gap-2 mb-2 flex-wrap">
        <span class="bg-emerald-50 text-emerald-600 text-xs px-2 py-1 rounded flex items-center gap-1">
          <i class="fa-solid fa-money-bill"></i> COD
        </span>
        <span class="bg-emerald-50 text-emerald-600 text-xs px-2 py-1 rounded flex items-center gap-1">
          <i class="fa-solid fa-truck-fast"></i> Free Delivery
        </span>
        <span class="bg-emerald-50 text-emerald-600 text-xs px-2 py-1 rounded flex items-center gap-1">
          <i class="fa-brands fa-whatsapp"></i> WhatsApp Order
        </span>
      </div>

      <form @submit.prevent="placeOrderWhatsApp" class="space-y-3">

        <input type="text" x-model="billing.name" placeholder="Full Name" required
               class="w-full border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">

        <input type="tel" x-model="billing.phone" placeholder="Phone Number" required
               class="w-full border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">

        <div class="grid grid-cols-2 gap-2">
          <input type="text" x-model="billing.city" placeholder="City" required
                 class="border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">
          <input type="text" x-model="billing.district" placeholder="District" required
                 class="border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">
          <input type="text" x-model="billing.state" placeholder="State" required
                 class="border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">
          <input type="text" x-model="billing.pincode" placeholder="Pincode" required
                 class="border rounded px-3 py-2 focus:outline-emerald-500 shadow-sm">
        </div>

        <button type="submit"
                class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-semibold flex justify-center items-center gap-2 shadow-lg transition transform hover:scale-105 fixed bottom-4 left-4 right-4 z-50">
          <i class="fa-brands fa-whatsapp text-lg"></i> Place Order via WhatsApp
        </button>
      </form>
    </section>

  </main>

  <!-- AlpineJS -->
  <script>
    function checkout() {
      return {
        cart: [],
        billing: { name:'', phone:'', city:'', district:'', state:'', pincode:'' },
        get cartTotal() {
          return this.cart.reduce((sum,item) => sum + item.price*item.quantity,0);
        },
        get mrpTotal() {
          return this.cart.reduce((sum,item) => sum + (item.originalPrice || item.price)*item.quantity,0);
        },
        init() {
          const saved = localStorage.getItem('cart');
          if(saved) this.cart = JSON.parse(saved);
        },
        placeOrderWhatsApp() {
          if(this.cart.length === 0){
            alert("Your cart is empty!");
            return;
          }
          const cartText = this.cart.map(item => `â€¢ ${item.name} x${item.quantity} = â‚¹${item.price*item.quantity}`).join('%0A');
          const message = `ğŸ›’ *New Order* ğŸ›’%0A%0A` +
                          `ğŸ‘¤ Name: ${this.billing.name}%0A` +
                          `ğŸ“ Phone: ${this.billing.phone}%0A` +
                          `ğŸ™ City: ${this.billing.city}%0A` +
                          `ğŸ“ District: ${this.billing.district}%0A` +
                          `ğŸ› State: ${this.billing.state}%0A` +
                          `ğŸ“® Pincode: ${this.billing.pincode}%0A%0A` +
                          `ğŸ› Order Items:%0A${cartText}%0A%0A` +
                          `ğŸ’° Total: â‚¹${this.cartTotal}%0A` +
                          `ğŸ’³ Payment: COD%0AğŸšš Free Delivery`;
          const waLink = `https://wa.me/91YOUR_NUMBER?text=${message}`;
          window.open(waLink,'_blank');
          localStorage.removeItem('cart');
        }
      }
    }
  </script>

</body>
</html>
